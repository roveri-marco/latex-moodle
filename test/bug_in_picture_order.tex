% !TeX encoding = UTF-8
% !TeX spellcheck = en_US
\documentclass[twocolumn]{article}
\usepackage[cm]{fullpage}
\usepackage[final]{../moodle}
\usepackage{tikz}
\usepackage{varwidth}

\tikzstyle{pict} = [minimum height=1em,inner sep=0pt,execute at begin 
node={\begin{varwidth}{\linewidth}},
execute at end node={\end{varwidth}}]

\newcommand\embedaspict[1]{\begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax
 ]\node[pict]{\mbox{#1}};\end{tikzpicture}}
 
\htmlregister{\embedaspict}

\begin{document}


\begin{quiz}{Test}
	
\begin{multi}{Picture Order}
Tikzexternalize (counter ``numconvertedpictures") refers to pictures with 
increasing numbers starting from 1 in this order: 1) question field, in order 
of appearance, then, for each item, in order of appearance, 2) answer field, 
in order of appearance, and 3) feedback field, in order of appearance.

Instead, when writing the XML, the counter ``numpicturesread" follows this 
order: for each item, in order of appearance, 1) answer field, in order of 
appearance, and 2) feedback field, in order of appearance, last 3) the 
question field, in order of appearance.

Picture in question: \embedaspict{1} (should read ``1" in Moodle)
\item[feedback={Picture in feedback 1: \embedaspict{3}  (should read ``3" in 
Moodle)}]* Picture in answer 1: \embedaspict{2}  (should read ``2" in Moodle)
\item[feedback={Picture in feedback 2: \embedaspict{5}  (should read ``5" in 
Moodle)}] Picture in answer 2: \embedaspict{4}  (should read ``4" in Moodle)
\end{multi}

%% Working
%\begin{cloze}{Cloze}
%	Picture in general text: \embedaspict{1} (should read ``1" in Moodle)
%	\begin{multi}[vertical]
%		Picture in question: \embedaspict{2} (should read ``2" in Moodle)
%		\item[feedback={Picture in feedback 1: \embedaspict{4} (should read 
%``4" in 
%			Moodle)}]* Picture in answer 1: \embedaspict{3} (should read ``3" 
%in Moodle)
%		\item[feedback={Picture in feedback 2: \embedaspict{6} (should read 
%``6" in 
%			Moodle)}] Picture in answer 2: \embedaspict{5} (should read ``5" in 
%Moodle)
%	\end{multi}
%	
%	\begin{numerical}[tolerance=0.01]
%		Picture in question: \embedaspict{7} (should read ``7" in Moodle)
%		
%		\item[feedback={Picture in feedback 1: \embedaspict{8} (should read 
%``8" in 
%			Moodle)}] 10
%		\item[fraction=0] 5
%		\item[fraction=0,feedback={$ax+b$}] 3
%	\end{numerical}
%	
%	\begin{multi}[horizontal]
%		Picture in question: \embedaspict{9} (should read ``9" in Moodle)
%		\item[feedback={Picture in feedback 1: \embedaspict{11} (should read 
%``11" in 
%			Moodle)}]* Picture in answer 1: \embedaspict{10} (should read ``10" 
%in Moodle)
%		\item[feedback={Picture in feedback 2: \embedaspict{13} (should read 
%``13" in 
%			Moodle)}] Picture in answer 2: \embedaspict{12} (should read ``12" 
%in Moodle)
%	\end{multi}
%	
%	\begin{shortanswer}[usecase]
%		Picture in question: \embedaspict{13} (should read ``13" in Moodle)
%		
%		\item[feedback={Picture in feedback 1: \embedaspict{14} (should read 
%``14" in 
%			Moodle)}] a
%		\item c
%		\item[fraction=0,feedback={Picture in feedback 2: \embedaspict{15} 
%(should read 
%			``15" in Moodle)}] b
%	\end{shortanswer}
%	
%	\begin{multi}
%		Picture in question: \embedaspict{16} (should read ``16" in Moodle)
%		\item[feedback={Picture in feedback 1: \embedaspict{17} (should read 
%``17" in 
%			Moodle)}]* a
%		\item[feedback={Picture in feedback 2: \embedaspict{18} (should read 
%``18" in 
%			Moodle)}] b
%	\end{multi}
%\end{cloze}

\end{quiz}
\end{document}